<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>主页</title>
    <!--通用js配置 axios http-->
    <th:block th:replace="~{template::commonJs}"></th:block>
</head>
<body>
<div id="app">
    <n-layout style="height: 100%">
        <n-layout-header style="height:40px;background-color: rgb(0,21,40)">
            <n-flex justify="space-between">
                <p style="font-size: 24px;font-weight: 800;margin: 0;color: white">网关管理</p>
                <n-button style="margin-top: 5px" type="error" size="small" @click="logout">退出</n-button>
            </n-flex>
        </n-layout-header>
        <n-layout has-sider style="height: calc(100vh - 40px)">
            <n-layout-sider
                    :native-scrollbar="false"
                    bordered
                    collapse-mode="width"
                    :collapsed-width="16"
                    :width="150"
                    show-trigger
                    :inverted="inverted"
            >
                <n-menu
                        :inverted="inverted"
                        :collapsed-width="64"
                        :collapsed-icon-size="22"
                        :options="menuOptions"
                        default-value="online-user-manage"
                        @update:value="menuSelectChange"
                />
            </n-layout-sider>
            <n-layout-content content-style="height: 100%" :native-scrollbar="false">
                <iframe src="./onlineUser" style="margin:0;border:0;width: 100%;height:100%;" name="content_frame"></iframe>
            </n-layout-content>
        </n-layout>
    </n-layout>
</div>
</body>
<script>
    const { defineComponent, h, createApp, ref } = Vue;
    const { NButton, NTag, NIcon, createDiscreteApi } = naive;
    const { message } = createDiscreteApi(['message']);

    function renderIcon(icon) {
        return () => h(NIcon, null, { default: () => h(icon) });
    }

    const menuOptions = [
        {
            label: () => h("a",
                {
                    href: "./onlineUser",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "在线用户管理"
            ),
            key: "online-user-manage"
            // icon: renderIcon(BookIcon)
        },
        {
            label: () => h("a",
                {
                    href: "./user",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "用户管理"
            ),
            key: "user-manage"
            // icon: renderIcon(BookIcon)
        },
        {
            label: () => h("a",
                {
                    href: "./group",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "用户组管理"
            ),
            key: "group-manage"
            // icon: renderIcon(BookIcon)
        },
        {
            label: () => h("a",
                {
                    href: "./role",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "角色管理"
            ),
            key: "role-manage"
            // icon: renderIcon(BookIcon),
            // disabled: true
        },
        {
            label: () => h("a",
                {
                    href: "./authority",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "权限管理"
            ),
            key: "authority-manage"
            // disabled: true,
            // icon: renderIcon(BookIcon)
        },
        {
            label: () => h("a",
                {
                    href: "./project",
                    target: "content_frame",
                    rel: "noopenner noreferrer"
                },
                "项目管理"
            ),
            key: "project-manage"
            // disabled: true,
            // icon: renderIcon(BookIcon)
        }
    ];

    const app = createApp({
        setup() {
            // 入口函数
            // 配和 <n-message-provider/> 标签使用
            // const message = useMessage();
            return {
                inverted: ref(true),
                menuOptions
            };
        },
        methods: {
            logout() {
                axios.get('/logout')
                    .then(() => {
                        Cookies.remove("token");
                        window.location.href = '/';
                })
            },
            menuSelectChange(key, item) {
                console.log(item)
            }
        }
    }).use(naive).mount('#app');
</script>
</html>